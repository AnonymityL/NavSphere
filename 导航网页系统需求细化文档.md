导航网页系统需求细化文档
V3.2 · 最终版（Astro 纯前端 · 环境内联展示）

技术栈：Astro + TypeScript + YAML（或 JSON）
架构模式：纯前端 · 静态站点生成（SSG）
数据来源：本地数据文件（Git 管理）
构建方式：Git 提交 → 构建 → 生成静态导航页面
适用场景：内部系统导航 / 测试 & 生产入口索引 / 长期稳定工具页

1. 项目目标与设计原则
1.1 项目目标

构建一个：

无后端

无数据库

无运行期接口

几乎零运维成本

用于集中展示：

项目测试 / 预发 / 生产环境访问入口

常用开发工具、平台类网址

支持单人长期维护，也支持团队通过 Git 协作维护

1.2 核心设计原则

Data as Code（数据即代码）

构建期失败优于运行期出错

Git 即唯一管理后台

导航系统 ≠ Web 应用

最少 JavaScript，最少心智负担

几年不动也不会坏

2. 系统整体架构设计
2.1 架构概览
Repository
├─ data/                  # 导航数据（YAML / JSON）
│  ├─ categories.yaml
│  ├─ projects.yaml
│  ├─ project-envs.yaml
│  └─ links.yaml
│
├─ scripts/               # 构建期校验
│  └─ validate.ts
│
├─ src/
│  ├─ pages/
│  │  └─ index.astro      # 导航首页
│  │
│  └─ components/
│     ├─ Search.astro     # 搜索（Client）
│     ├─ CategoryBlock.astro
│     ├─ NavItem.astro    # 单条导航项
│     └─ EnvTag.astro     # 环境标识
│
└─ dist/                  # 构建产物（静态站点）

2.2 数据流说明
修改 data/*.yaml
   ↓
Git 提交
   ↓
构建期数据校验（失败即中断）
   ↓
Astro Build
   ↓
生成纯静态 HTML + 少量 JS

3. 页面级需求
3.1 导航首页（/）
3.1.1 页面目标

提供所有导航入口的唯一入口页

页面加载即拥有完整数据

不依赖任何运行期请求或接口

3.1.2 页面结构
[ 搜索框 ]

[ 分类 A ]
  ├─ 项目 A（测试）
  ├─ 项目 A（生产）
  ├─ 项目 B（生产）
  └─ 通用链接
       ├─ GitHub
       └─ ChatGPT

[ 分类 B ]
...


说明：

每一行即一个可点击导航项

项目环境通过 项目名称内联标注

不再存在“环境按钮”概念

3.1.3 点击行为

点击项目 / 链接：

window.open(url, '_blank')

URL 为空或非法：

禁止点击

显示禁用样式

3.1.4 空状态与异常
场景	行为
无任何分类	显示「暂无导航数据」
分类下无内容	分类标题仍显示
URL 非法	禁止点击
4. 搜索功能设计
4.1 搜索行为

输入即搜索（300ms debounce）

前端纯过滤，不修改原始数据

不触发路由变化

4.2 搜索匹配范围

分类名称

项目名称

环境名称（测试 / 预发 / 生产）

URL

示例：

搜索「测试」→ 显示所有测试环境项目

搜索「生产」→ 显示所有生产环境项目

4.3 搜索结果规则

仅显示命中的分类

分类下仅显示命中的导航项

分类顺序保持原顺序不变

5. 数据设计（核心）

推荐使用 YAML，便于人工维护和 Code Review

5.1 分类数据（categories.yaml）
- id: dev
  name: 研发系统
  description: 内部研发相关系统
  order: 1

约束规则

id 全局唯一，不可修改

order 为数字，用于排序

5.2 项目数据（projects.yaml）
- id: user-center
  name: 用户中心
  categoryId: dev
  description: 用户相关核心系统

约束规则

id 唯一

name 唯一

categoryId 必须存在于分类中

5.3 项目环境数据（project-envs.yaml）
- projectId: user-center
  env: PROD
  url: https://prod.example.com
  remark: 正式环境

强制约束

同一 projectId + env 只能存在一条

env 仅允许：

TEST

PRE

PROD

URL 必须是合法 URL

5.4 通用网址数据（links.yaml）
- name: ChatGPT
  url: https://chat.openai.com
  categoryId: dev
  enabled: true

约束规则

enabled=false → 不在首页展示

categoryId 必须存在

6. 构建期数据校验（等价后端校验）
6.1 校验时机

本地 astro build

CI Pipeline

可选：pre-commit hook

6.2 必须校验项
类型	校验内容
分类	id 唯一
分类	order 为数字
项目	id 唯一
项目	name 唯一
项目	categoryId 存在
环境	projectId 存在
环境	projectId + env 唯一
环境	env 合法
URL	URL 格式正确

任一校验失败 → 构建直接失败

6.3 构建接入方式
{
  "scripts": {
    "build": "node scripts/validate.js && astro build"
  }
}

7. 构建期数据聚合规则
7.1 聚合目标

将「项目 + 环境」拆平成可直接渲染的导航项

7.2 聚合后的 ViewModel
NavigationItem {
  id: string
  displayName: string   // 用户中心（生产）
  env: 'TEST' | 'PRE' | 'PROD'
  url: string
  categoryId: string
}

7.3 聚合逻辑说明
project × env
  ↓
NavigationItem


一个项目有多个环境 → 多条导航项

没有环境的项目 → 不展示

7.4 分类内排序建议

项目导航项

PROD → PRE → TEST

通用链接

8. Astro 页面与组件设计
8.1 页面
页面	说明
/	导航首页
8.2 组件职责划分
组件	职责
Search	搜索输入（Client）
CategoryBlock	分类块
NavItem	单条导航项
EnvTag	环境标识（纯展示）
9. 前端工程约束

TypeScript 强制

数据只允许在构建期读取

禁止运行时 fetch

JS Islands 最小化

不引入重量级状态管理

10. 权限与安全策略

❌ 不提供在线管理

❌ 不提供接口

❌ 不支持运行期修改

✅ 所有变更通过 Git

✅ 生产环境 URL 修改需 PR 审核

11. CI / CD 推荐流程
push
 ↓
install
 ↓
validate data
 ↓
astro build
 ↓
deploy static site

12. 明确不做的事情

在线 CRUD

登录 / 权限系统

后端 API

数据库

运行期配置修改

13. 可演进方向（非当前范围）

多导航首页（/dev / /ops）

YAML → JSON Schema 校验

自动生成 Markdown / README

本地只读管理视图

14. 最终总结

这是一个：

极简

稳定

不容易被玩坏

非常适合长期存在的导航系统

的设计方案。